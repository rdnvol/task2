<div class="filter-collapse">
  <details-utils
    force-open
    animate
    force-restore
  >
    <details
      class="filter-collapse__item js-filter"
      data-index="{{ forloop.index }}"
    >
      <summary class="flex items-center justify-between py-3">
        {{ filter.label }}
        <span class="filter-collapse__btn mx-4 shrink-0"></span>
      </summary>

      <div class="overflow-hidden">
        {% for value in filter.values %}
          {% unless forloop.index > 5 %}
            <div class="custom-input custom-input--square-with-text py-3">
              <input
                id="Filter-{{ value.param_name }}-{{ forloop.index }}"
                type="checkbox"
                value="{{ value.value }}"
                name="{{ value.param_name }}"
                {% if value.active -%}
                  checked
                {%- endif %}
                {% if value.count == 0 and value.active == false -%}
                  disabled
                {%- endif %}
              >
              <label
                for="Filter-{{ value.param_name }}-{{ forloop.index }}"
                class="custom-label flex items-center"
              >
                <span class="custom-label__check"></span>
                {{ value.label }} ({{ value.count }})
              </label>
            </div>
          {% endunless %}
        {% endfor %}
        {% if filter.values.size >= 5 %}
          <more-less class="filter-collapse__btn-more-content mb-3 inline-block pt-4">
            {%
              render 'button',
              element: 'button',
              data_attribute: 'data-id="more"',
              class: 'default filter-collapse__more',
              text: '+ More'
            %}
            {%
              render 'button',
              element: 'button',
              data_attribute: 'data-id="less"',
              class: 'default filter-collapse__less',
              text: '- Less'
            %}

            <script id="filter-items" data-template="1" type="application/json">
              {
                "filter_label": {{ filter.label | json }},
                "filter_type": {{ filter.type | json }},
                "filter_values": [
                  {% for value in filter.values %}
                    {
                      "active": {{ value.active | json }},
                      "count": {{ value.count | json }},
                      "label": {{ value.label | json }},
                      "param_name": {{ value.param_name | json }},
                      "value": {{ value.value | json }}
                    }
                  {% unless forloop.last %}
                    ,
                  {% endunless %}
                  {% endfor %}
                ]
              }
            </script>
          </more-less>
        {% endif %}
      </div>
    </details>
  </details-utils>
</div>
